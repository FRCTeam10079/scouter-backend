generator client {
  provider = "prisma-client"
  output   = "../src/db/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            Int            @id @default(autoincrement())
  username      String         @unique @db.VarChar(30)
  passwordHash  String         @db.VarChar(100)
  refreshTokens RefreshToken[]
  firstName     String         @db.VarChar(50)
  lastName      String         @db.VarChar(50)
  reports       Report[]
}

model RefreshToken {
  value     String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    Int
  expiresAt DateTime
}

enum MatchType {
  PRACTICE
  QUALIFICATION
  PLAYOFF
}

enum TrenchOrBump {
  TRENCH
  BUMP
}

model Report {
  id               Int          @id @default(autoincrement())
  user             User?        @relation(fields: [userId], references: [id], onDelete: SetNull)
  userId           Int?
  createdAt        DateTime
  eventCode        String       @db.Char(5)
  matchType        MatchType
  matchNumber      Int          @db.SmallInt
  teamNumber       Int          @db.SmallInt
  notes            String       @db.VarChar(400)
  trenchOrBump     TrenchOrBump
  minorFouls       Int          @db.SmallInt
  majorFouls       Int          @db.SmallInt
  autoNotes        String       @db.VarChar(400)
  autoMovement     Boolean
  autoHubScore     Int          @db.SmallInt
  autoHubMisses    Int          @db.SmallInt
  autoLevel1       Boolean
  teleopNotes      String       @db.VarChar(400)
  teleopHubScore   Int          @db.SmallInt
  teleopHubMisses  Int          @db.SmallInt
  teleopLevel      Int          @db.SmallInt
  endgameNotes     String       @db.VarChar(400)
  endgameHubScore  Int          @db.SmallInt
  endgameHubMisses Int          @db.SmallInt
  endgameLevel     Int          @db.SmallInt
}
